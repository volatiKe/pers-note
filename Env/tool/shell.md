# Shell 常用命令

## 脚本执行

|执行方式|是否开启子 shell|脚本中的变量可读性|是否需要脚本的可执行权限|
|---|---|---|---|
|source（或```.```)|否|脚本中创建的变量或者环境变量（export 的变量）相当于是在当前 shell 中创建的，当前 shell 可以访问，所以 source 执行修改后的配置文件会直接生效|不需要|
|bash（或 sh、zsh)|是|脚本中创建的变量或者环境变量（export 的变量）只在子 shell 中有效，当前 shell 无法访问|不需要|
|./|是|同上|需要|

**export**:export 是 bash 的一个内置命令，可以将父 shell 里的变量导出供子 shell 使用

* 用 export 导出的变量放在「导出变量列表」中，它可以被子 shell 拷贝并使用
* 被 export 出来的变量虽然可以被子 shell 使用，但只是一个拷贝，不会影响到父 shell 中的值以及其它子 shell 中的值

## sed

sed 的处理单位为**一行**，命令使用```''```包裹

### 参数

* **-n**:sed 默认在执行完命令后将输入的每一行打印在标准输出上，此参数避免了此行为
* **-i**: 所有的改动在源文件上执行，输出覆盖源文件

### 内容

* **s/内容 1/内容 2/**: 将内容 1 替换为内容 2
* **g**: 默认 sed 只处理每行匹配到的第一个内容，g 表示 global，处理全文内容，如```s/xxx/xxx/g```
* **p**: 打印行，一般和```-n```一起使用，如```sed -n '1,3p' input-file```为打印文件 1 到 3 行

## awk

awk 的处理单位为**一行**，根据分割符分解成多个域，再对每一个域根据命令进行处理

命令范式

```shell
awk -F '分隔符' '{命令}' input-file
```

其中：

* -F 可省略，表示分隔符为空格
* ```$0```表示整行内容
* 分割后的列从```$1```开始
* 内置变量：
  * NF: 一行分割后域的个数
  * NR: 行号

```shell
awk -F "|" '{OFS="|"} {$9=20210302}1' temp > result
```

表示将 temp 中的第 9 列替换为 20210302

* 替换后的行默认使用空格做分隔符，所以需要指定分隔符
* 1 表示打印替换后的行

## curl

* **-X**: 指定请求方式，不写时默认 GET，如```curl -X POST https://www.baidu.com```
* **-H**: 指定请求头，如```-H 'Content-Type: application/json'```
* **-d**:POST 请求时指定请求体，需要注意的是这个参数会自动加上```Content-Type : application/x-www-form-urlencoded```这个请求头，并且转换为 POST 请求
* **-o**: 将请求的响应保存为文件，如```curl -o filename.html https://www.baidu.com```，相当于```wget```
* **-s**: 不显示进度
